{% extends "blog/base_blog.html" %}
{% block content %}

<div class="blog-header-actions">
    <h1>Blog</h1>
    <a href="{% url 'blog:crear_post' %}" class="btn-crear-post">+ Crear Post</a>
</div>

<div class="blog-posts">
    {% for post in posts %}
    <div class="post">
        <h3>
          <a href="{% url 'blog:post_detail' post.pk %}" class="post-link">{{ post.titulo }}</a>
        </h3>
        {% if post.imagen %}
            <img src="{{ post.imagen.url }}" alt="{{ post.titulo }}" style="max-width:100%; border-radius:6px; margin-bottom:0.5rem;">
        {% endif %}
        <p>{{ post.contenido|truncatewords:30 }}</p>
        
        {% if user.is_staff %}
            <form method="post" action="{% url 'blog:delete_post' post.pk %}" 
                  onsubmit="return confirm('¿Eliminar este post?')" style="display:inline;">
                {% csrf_token %}
                <button type="submit" style="color:red; border:none; background:none; cursor:pointer;">
                    Eliminar
                </button>
            </form>
        {% endif %}
        
        <a href="{% url 'blog:post_detail' post.pk %}" class="post-link">Ver post completo</a>
    </div>
    {% empty %}
        <p>No hay posts aún.</p>
    {% endfor %}
</div>
{% endblock %}